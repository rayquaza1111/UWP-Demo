<Page
    x:Class="UWP_Demo.Views.HomePage"
    x:Name="pageRoot"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:UWP_Demo.Views"
    xmlns:viewmodels="using:UWP_Demo.ViewModels"
    xmlns:models="using:UWP_Demo.Models"
    xmlns:muxc="using:Microsoft.UI.Xaml.Controls"
    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">

    <!-- ?? HOME DASHBOARD: Overview and quick access to all app features -->
    <!-- ?? Purpose: Central hub with statistics, quick actions, and recent activity -->
    <!-- ?? Features: Overview cards, quick navigation, recent customers, statistics -->
    <Page.DataContext>
        <viewmodels:HomeViewModel />
    </Page.DataContext>

    <ScrollViewer>
        <StackPanel Margin="24" Spacing="24">
            
            <!-- ?? DASHBOARD: Welcome header -->
            <StackPanel Spacing="8">
                <StackPanel Orientation="Horizontal" Spacing="12">
                    <Border Background="{ThemeResource AccentFillColorDefaultBrush}"
                            CornerRadius="6"
                            Width="40"
                            Height="40">
                        <SymbolIcon Symbol="Home" 
                                    Foreground="White"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center" />
                    </Border>
                    <StackPanel VerticalAlignment="Center">
                        <TextBlock Text="Dashboard" 
                                   FontSize="28" 
                                   FontWeight="SemiBold"
                                   Foreground="{ThemeResource TextFillColorPrimaryBrush}" />
                        <TextBlock Text="Welcome to Customer Management - your business overview" 
                                   FontSize="14" 
                                   Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                    </StackPanel>
                </StackPanel>
            </StackPanel>

            <!-- 6. Suspension & Resume Handling: Welcome back message -->
            <muxc:InfoBar x:Name="WelcomeInfoBar"
                          Title="Welcome Back!"
                          Message="{Binding WelcomeMessage}"
                          Severity="Success"
                          IsOpen="{Binding ShowWelcomeMessage}"
                          IsClosable="True"
                          Closed="WelcomeInfoBar_Closed">
                <muxc:InfoBar.ActionButton>
                    <Button Content="Got it!"
                            Command="{Binding DismissWelcomeCommand}"
                            Style="{ThemeResource AccentButtonStyle}" />
                </muxc:InfoBar.ActionButton>
            </muxc:InfoBar>

            <!-- ?? DASHBOARD: Quick stats overview -->
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                
                <!-- Customer count card -->
                <Border Grid.Column="0" 
                        Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                        BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                        BorderThickness="1"
                        CornerRadius="8"
                        Padding="20"
                        Margin="0,0,8,0">
                    <StackPanel Spacing="8">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <SymbolIcon Symbol="People" Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}" />
                            <TextBlock Text="Total Customers" FontWeight="SemiBold" />
                        </StackPanel>
                        <TextBlock Text="{Binding Customers.Count}" FontSize="32" FontWeight="Bold" />
                        <TextBlock Text="{Binding CustomerSummary}" FontSize="12" Opacity="0.7" />
                    </StackPanel>
                </Border>
                
                <!-- Database status card -->
                <Border Grid.Column="1" 
                        Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                        BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                        BorderThickness="1"
                        CornerRadius="8"
                        Padding="20"
                        Margin="4,0">
                    <StackPanel Spacing="8">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <SymbolIcon Symbol="Folder" Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}" />
                            <TextBlock Text="Database Status" FontWeight="SemiBold" />
                        </StackPanel>
                        <TextBlock Text="Active" FontSize="24" FontWeight="Bold" />
                        <TextBlock Text="File operations working" FontSize="12" Opacity="0.7" />
                    </StackPanel>
                </Border>
                
                <!-- Quick actions card -->
                <Border Grid.Column="2" 
                        Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                        BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                        BorderThickness="1"
                        CornerRadius="8"
                        Padding="20"
                        Margin="8,0,0,0">
                    <StackPanel Spacing="8">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon Glyph="&#xE945;" Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}" />
                            <TextBlock Text="Quick Access" FontWeight="SemiBold" />
                        </StackPanel>
                        <Button Command="{Binding NavigateToNewCustomerCommand}"
                                Style="{ThemeResource AccentButtonStyle}"
                                HorizontalAlignment="Stretch">
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <SymbolIcon Symbol="Add" />
                                <TextBlock Text="New Customer" />
                            </StackPanel>
                        </Button>
                    </StackPanel>
                </Border>
            </Grid>

            <!-- ?? DASHBOARD: Navigation cards -->
            <StackPanel Spacing="12">
                <TextBlock Text="?? Application Sections" 
                           FontSize="20" 
                           FontWeight="SemiBold"
                           Foreground="{ThemeResource TextFillColorPrimaryBrush}" />
                           
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    
                    <!-- Customers section -->
                    <Border Grid.Row="0" Grid.Column="0"
                            Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                            BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                            BorderThickness="1"
                            CornerRadius="8"
                            Padding="20"
                            Margin="0,0,8,8">
                        <StackPanel Spacing="12">
                            <StackPanel Orientation="Horizontal" Spacing="12">
                                <SymbolIcon Symbol="People" Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}" />
                                <TextBlock Text="Customer Directory" FontSize="16" FontWeight="SemiBold" />
                            </StackPanel>
                            <TextBlock Text="Browse, search, and manage all your customers with advanced filtering and bulk operations."
                                       TextWrapping="Wrap"
                                       FontSize="14"
                                       Opacity="0.8" />
                            <Button x:Name="ViewCustomersButton"
                                    Content="View Customers" 
                                    HorizontalAlignment="Stretch"
                                    Style="{ThemeResource AccentButtonStyle}"
                                    Click="ViewCustomersButton_Click" />
                        </StackPanel>
                    </Border>
                    
                    <!-- Network API section - COMMENTED OUT -->
                    <!--
                    <Border Grid.Row="0" Grid.Column="1"
                            Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                            BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                            BorderThickness="1"
                            CornerRadius="8"
                            Padding="20"
                            Margin="8,0,0,8">
                        <StackPanel Spacing="12">
                            <StackPanel Orientation="Horizontal" Spacing="12">
                                <SymbolIcon Symbol="Globe" Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}" />
                                <TextBlock Text="Network API Demo" FontSize="16" FontWeight="SemiBold" />
                            </StackPanel>
                            <TextBlock Text="Test HTTP requests, connect to JSONPlaceholder API, and import external data into your customer database."
                                       TextWrapping="Wrap"
                                       FontSize="14"
                                       Opacity="0.8" />
                            <Button x:Name="NetworkApiButton"
                                    Content="Try Network API" 
                                    HorizontalAlignment="Stretch"
                                    Style="{ThemeResource AccentButtonStyle}"
                                    Click="NetworkApiButton_Click" />
                        </StackPanel>
                    </Border>
                    -->

                    <!-- Customer Editor section (moved to position 0,1) -->
                    <Border Grid.Row="0" Grid.Column="1"
                            Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                            BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                            BorderThickness="1"
                            CornerRadius="8"
                            Padding="20"
                            Margin="8,0,0,8">
                        <StackPanel Spacing="12">
                            <StackPanel Orientation="Horizontal" Spacing="12">
                                <SymbolIcon Symbol="Edit" Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}" />
                                <TextBlock Text="Customer Editor" FontSize="16" FontWeight="SemiBold" />
                            </StackPanel>
                            <TextBlock Text="Create new customers or edit existing ones with our intuitive form interface and real-time validation."
                                       TextWrapping="Wrap"
                                       FontSize="14"
                                       Opacity="0.8" />
                            <Button Content="Open Editor" 
                                    HorizontalAlignment="Stretch"
                                    Style="{ThemeResource AccentButtonStyle}"
                                    Click="ViewCustomersButton_Click" />
                        </StackPanel>
                    </Border>
                    
                    <!-- File Operations section -->
                    <Border Grid.Row="1" Grid.Column="0"
                            Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                            BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                            BorderThickness="1"
                            CornerRadius="8"
                            Padding="20"
                            Margin="0,8,8,8">
                        <StackPanel Spacing="12">
                            <StackPanel Orientation="Horizontal" Spacing="12">
                                <SymbolIcon Symbol="Folder" Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}" />
                                <TextBlock Text="File Operations" FontSize="16" FontWeight="SemiBold" />
                            </StackPanel>
                            <TextBlock Text="Import, export, backup, and manage your customer data files with advanced file operations."
                                       TextWrapping="Wrap"
                                       FontSize="14"
                                       Opacity="0.8" />
                            <Button x:Name="ManageFilesButton"
                                    Content="Manage Files" 
                                    HorizontalAlignment="Stretch"
                                    Style="{ThemeResource AccentButtonStyle}"
                                    Click="ManageFilesButton_Click" />
                        </StackPanel>
                    </Border>
                    
                    <!-- Reports section -->
                    <Border Grid.Row="1" Grid.Column="1"
                            Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                            BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                            BorderThickness="1"
                            CornerRadius="8"
                            Padding="20"
                            Margin="8,8,0,8">
                        <StackPanel Spacing="12">
                            <StackPanel Orientation="Horizontal" Spacing="12">
                                <SymbolIcon Symbol="Library" Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}" />
                                <TextBlock Text="Analytics &amp; Reports" FontSize="16" FontWeight="SemiBold" />
                            </StackPanel>
                            <TextBlock Text="Generate insights, charts, and reports about your customer data and business trends."
                                       TextWrapping="Wrap"
                                       FontSize="14"
                                       Opacity="0.8" />
                            <Button Content="View Reports" 
                                    HorizontalAlignment="Stretch"
                                    IsEnabled="False" />
                        </StackPanel>
                    </Border>
                    
                    <!-- Settings section -->
                    <Border Grid.Row="2" Grid.Column="0"
                            Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                            BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                            BorderThickness="1"
                            CornerRadius="8"
                            Padding="20"
                            Margin="0,8,8,0">
                        <StackPanel Spacing="12">
                            <StackPanel Orientation="Horizontal" Spacing="12">
                                <SymbolIcon Symbol="Setting" Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}" />
                                <TextBlock Text="App Settings" FontSize="16" FontWeight="SemiBold" />
                            </StackPanel>
                            <TextBlock Text="Configure themes, test app features, and manage application preferences and settings."
                                       TextWrapping="Wrap"
                                       FontSize="14"
                                       Opacity="0.8" />
                            <Button Content="Open Settings" 
                                    HorizontalAlignment="Stretch"
                                    Click="SettingsButton_Click" />
                        </StackPanel>
                    </Border>

                    <!-- Internet Capabilities Info - COMMENTED OUT -->
                    <!--
                    <Border Grid.Row="2" Grid.Column="1"
                            Background="{ThemeResource SystemControlBackgroundAccentBrush}"
                            BorderBrush="{ThemeResource SystemControlForegroundAccentBrush}"
                            BorderThickness="2"
                            CornerRadius="8"
                            Padding="20"
                            Margin="8,8,0,0">
                        <StackPanel Spacing="12">
                            <StackPanel Orientation="Horizontal" Spacing="12">
                                <FontIcon Glyph="&#xE968;" Foreground="White" />
                                <TextBlock Text="Internet Capabilities" FontSize="16" FontWeight="SemiBold" Foreground="White" />
                            </StackPanel>
                            <TextBlock Text="This app has Internet (Client) capability enabled in the manifest, allowing HTTP requests to external APIs."
                                       TextWrapping="Wrap"
                                       FontSize="14"
                                       Foreground="White"
                                       Opacity="0.9" />
                            <TextBlock Text="? JSONPlaceholder API Ready"
                                       FontSize="12"
                                       FontWeight="SemiBold"
                                       Foreground="White" />
                        </StackPanel>
                    </Border>
                    -->

                    <!-- File I/O Info (moved to position 2,1) -->
                    <Border Grid.Row="2" Grid.Column="1"
                            Background="{ThemeResource SystemControlBackgroundAccentBrush}"
                            BorderBrush="{ThemeResource SystemControlForegroundAccentBrush}"
                            BorderThickness="2"
                            CornerRadius="8"
                            Padding="20"
                            Margin="8,8,0,0">
                        <StackPanel Spacing="12">
                            <StackPanel Orientation="Horizontal" Spacing="12">
                                <FontIcon Glyph="&#xE8B7;" Foreground="White" />
                                <TextBlock Text="File I/O Capabilities" FontSize="16" FontWeight="SemiBold" Foreground="White" />
                            </StackPanel>
                            <TextBlock Text="Customer data is automatically saved to local JSON files for persistence across app sessions."
                                       TextWrapping="Wrap"
                                       FontSize="14"
                                       Foreground="White"
                                       Opacity="0.9" />
                            <TextBlock Text="? Auto-Save Enabled"
                                       FontSize="12"
                                       FontWeight="SemiBold"
                                       Foreground="White" />
                        </StackPanel>
                    </Border>
                </Grid>
            </StackPanel>

            <!-- ?? DASHBOARD: Recent activity -->
            <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="24">
                
                <StackPanel Spacing="16">
                    <StackPanel Orientation="Horizontal" Spacing="12">
                        <SymbolIcon Symbol="Clock" Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}" />
                        <TextBlock Text="Recent Activity" 
                                   FontSize="20" 
                                   FontWeight="SemiBold"
                                   Foreground="{ThemeResource TextFillColorPrimaryBrush}" />
                    </StackPanel>

                    <!-- Recent customers preview -->
                    <ItemsControl ItemsSource="{Binding FilteredCustomers}" MaxHeight="200">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate x:DataType="models:Customer">
                                <Border Background="{ThemeResource LayerFillColorDefaultBrush}"
                                       BorderBrush="{ThemeResource DividerStrokeColorDefaultBrush}"
                                       BorderThickness="1"
                                       Margin="0,0,0,8"
                                       Padding="16"
                                       CornerRadius="6">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>

                                        <StackPanel Grid.Column="0">
                                            <TextBlock Text="{x:Bind FullName}" FontWeight="SemiBold" FontSize="14" />
                                            <TextBlock Text="{x:Bind Email}" FontSize="12" Opacity="0.7" />
                                        </StackPanel>

                                        <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="8">
                                            <Button Content="Edit" 
                                                    Command="{Binding DataContext.NavigateToEditCommand, ElementName=pageRoot}"
                                                    CommandParameter="{x:Bind}"
                                                    Style="{ThemeResource AccentButtonStyle}"
                                                    Padding="8,4" />
                                        </StackPanel>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>

                    <!-- Quick actions -->
                    <StackPanel Orientation="Horizontal" Spacing="12" HorizontalAlignment="Center">
                        <Button Command="{Binding AddCustomerCommand}">
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <SymbolIcon Symbol="Add" />
                                <TextBlock Text="Quick Add" />
                            </StackPanel>
                        </Button>
                        
                        <Button Command="{Binding LoadExternalDataCommand}">
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <SymbolIcon Symbol="Download" />
                                <TextBlock Text="Load Sample" />
                            </StackPanel>
                        </Button>
                        
                        <Button Command="{Binding RefreshCommand}">
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <SymbolIcon Symbol="Refresh" />
                                <TextBlock Text="Refresh" />
                            </StackPanel>
                        </Button>
                        
                        <!-- 7. Error Simulation & Handling: Quick error test button -->
                        <Button x:Name="QuickErrorTestButton"
                                Click="QuickErrorTest_Click"
                                ToolTipService.ToolTip="Test error handling with file not found simulation">
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <FontIcon Glyph="&#xE7BA;" />
                                <TextBlock Text="Test Error" />
                            </StackPanel>
                        </Button>
                        
                        <!-- 6. Suspension & Resume Handling: Test suspension button -->
                        <Button x:Name="TestSuspensionButton"
                                Click="TestSuspensionButton_Click"
                                ToolTipService.ToolTip="Test suspension and resume functionality">
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <SymbolIcon Symbol="Play" />
                                <TextBlock Text="Test Suspend" />
                            </StackPanel>
                        </Button>
                    </StackPanel>
                </StackPanel>
            </Border>

            <!-- File status -->
            <muxc:InfoBar Title="Database Status"
                          Message="{Binding FileStatus}"
                          Severity="{Binding InfoBarSeverity}"
                          IsOpen="True"
                          IsClosable="False">
                <muxc:InfoBar.ActionButton>
                    <Button Content="File Details"
                            Command="{Binding ShowFileInfoCommand}"
                            Style="{ThemeResource AccentButtonStyle}" />
                </muxc:InfoBar.ActionButton>
            </muxc:InfoBar>
            
        </StackPanel>
    </ScrollViewer>
</Page>