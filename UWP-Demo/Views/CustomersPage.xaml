<Page
    x:Class="UWP_Demo.Views.CustomersPage"
    x:Name="pageRoot"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:UWP_Demo.Views"
    xmlns:viewmodels="using:UWP_Demo.ViewModels"
    xmlns:models="using:UWP_Demo.Models"
    xmlns:muxc="using:Microsoft.UI.Xaml.Controls"
    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">

    <!-- ?? CUSTOMERS PAGE: Dedicated customer list and management interface -->
    <!-- ?? Purpose: Pure customer browsing, searching, and management -->
    <!-- ?? Features: Advanced filtering, bulk operations, customer insights -->
    <Page.DataContext>
        <viewmodels:HomeViewModel />
    </Page.DataContext>

    <Grid Padding="24">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!-- ?? CUSTOMERS: Enhanced header with search focus -->
        <StackPanel Grid.Row="0" Margin="0,0,0,16">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                
                <StackPanel Grid.Column="0">
                    <TextBlock Text="Customer Directory" FontSize="28" FontWeight="SemiBold" />
                    <TextBlock Text="{Binding CustomerSummary}" FontSize="14" Opacity="0.6" Margin="0,4,0,0" />
                </StackPanel>
                
                <!-- Quick actions for customer management -->
                <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="8">
                    <Button Command="{Binding NavigateToNewCustomerCommand}" 
                            Style="{ThemeResource AccentButtonStyle}">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <SymbolIcon Symbol="Add" />
                            <TextBlock Text="New Customer" />
                        </StackPanel>
                    </Button>
                    
                    <Button Command="{Binding LoadExternalDataCommand}">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <SymbolIcon Symbol="Download" />
                            <TextBlock Text="Import" />
                        </StackPanel>
                    </Button>
                </StackPanel>
            </Grid>
        </StackPanel>

        <!-- ?? CUSTOMERS: Enhanced search and filter section -->
        <Border Grid.Row="1" 
                Background="{ThemeResource SystemControlBackgroundListMediumBrush}"
                BorderBrush="{ThemeResource SystemControlForegroundBaseLowBrush}"
                BorderThickness="1"
                CornerRadius="8"
                Padding="16"
                Margin="0,0,0,16">
            
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                
                <!-- Advanced search box -->
                <TextBox Grid.Column="0"
                         PlaceholderText="Search customers by name, email, or company..."
                         Text="{Binding SearchText, Mode=TwoWay}"
                         VerticalAlignment="Center">
                    <TextBox.Resources>
                        <Style TargetType="TextBox">
                            <Setter Property="Background" Value="Transparent" />
                        </Style>
                    </TextBox.Resources>
                </TextBox>
                
                <!-- Search actions -->
                <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="8">
                    <Button ToolTipService.ToolTip="Advanced Search">
                        <SymbolIcon Symbol="Filter" />
                    </Button>
                    <Button Command="{Binding RefreshCommand}" ToolTipService.ToolTip="Refresh">
                        <SymbolIcon Symbol="Refresh" />
                    </Button>
                </StackPanel>
            </Grid>
        </Border>

        <!-- ?? CUSTOMERS: Status information -->
        <muxc:InfoBar Grid.Row="2"
                      Title="Customer Database"
                      Message="{Binding FileStatus}"
                      Severity="{Binding InfoBarSeverity}"
                      IsOpen="True"
                      IsClosable="False"
                      Margin="0,0,0,16">
            <muxc:InfoBar.ActionButton>
                <Button Content="Database Info"
                        Command="{Binding ShowFileInfoCommand}"
                        Style="{ThemeResource AccentButtonStyle}" />
            </muxc:InfoBar.ActionButton>
        </muxc:InfoBar>

        <!-- ?? CUSTOMERS: Enhanced customer list with details -->
        <ScrollViewer Grid.Row="3">
            <ItemsControl ItemsSource="{Binding FilteredCustomers}">
                <ItemsControl.ItemTemplate>
                    <DataTemplate x:DataType="models:Customer">
                        <Border Background="{ThemeResource SystemControlBackgroundListMediumBrush}"
                               BorderBrush="{ThemeResource SystemControlForegroundBaseLowBrush}"
                               BorderThickness="1"
                               Margin="0,0,0,12"
                               Padding="20"
                               CornerRadius="8">
                            
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>

                                <!-- Customer avatar/initial -->
                                <Border Grid.Column="0"
                                        Background="{ThemeResource SystemControlBackgroundAccentBrush}"
                                        Width="48"
                                        Height="48"
                                        CornerRadius="24"
                                        Margin="0,0,16,0">
                                    <TextBlock Text="{x:Bind FirstName, Converter={StaticResource FirstCharConverter}}"
                                               FontSize="20"
                                               FontWeight="SemiBold"
                                               Foreground="White"
                                               HorizontalAlignment="Center"
                                               VerticalAlignment="Center" />
                                </Border>

                                <!-- Customer details -->
                                <StackPanel Grid.Column="1" VerticalAlignment="Center" Spacing="4">
                                    <TextBlock Text="{x:Bind FullName}" 
                                               FontWeight="SemiBold" 
                                               FontSize="16" />
                                    <TextBlock Text="{x:Bind Email}" 
                                               FontSize="14" 
                                               Opacity="0.8" />
                                    <StackPanel Orientation="Horizontal" Spacing="16">
                                        <TextBlock Text="{x:Bind Company}" 
                                                   FontSize="12" 
                                                   Opacity="0.6"
                                                   Visibility="{x:Bind Company, Converter={StaticResource StringToVisibilityConverter}}" />
                                        <TextBlock Text="{x:Bind Phone}" 
                                                   FontSize="12" 
                                                   Opacity="0.6"
                                                   Visibility="{x:Bind Phone, Converter={StaticResource StringToVisibilityConverter}}" />
                                    </StackPanel>
                                    <TextBlock Text="{x:Bind LastModified}" 
                                               FontSize="10" 
                                               Opacity="0.4" />
                                </StackPanel>

                                <!-- Customer actions -->
                                <StackPanel Grid.Column="2" 
                                            Orientation="Horizontal" 
                                            VerticalAlignment="Center"
                                            Spacing="8">
                                    <Button Content="View" 
                                            Style="{ThemeResource DefaultButtonStyle}"
                                            Padding="12,6" />
                                    <Button Content="Edit" 
                                            Command="{Binding DataContext.NavigateToEditCommand, ElementName=pageRoot}"
                                            CommandParameter="{x:Bind}"
                                            Click="EditCustomer_Click"
                                            Style="{ThemeResource AccentButtonStyle}"
                                            Padding="12,6" />
                                    <Button Content="Delete" 
                                            Command="{Binding DataContext.DeleteSelectedCustomerCommand, ElementName=pageRoot}"
                                            CommandParameter="{x:Bind}"
                                            Padding="12,6" />
                                </StackPanel>
                            </Grid>
                        </Border>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </ScrollViewer>

        <!-- ?? CUSTOMERS: Bulk operations and statistics -->
        <Border Grid.Row="4" 
                Background="{ThemeResource SystemControlBackgroundListLowBrush}"
                BorderBrush="{ThemeResource SystemControlForegroundBaseLowBrush}"
                BorderThickness="1"
                CornerRadius="8"
                Padding="16"
                Margin="0,16,0,0">
            
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                
                <!-- Customer statistics -->
                <StackPanel Grid.Column="0" VerticalAlignment="Center">
                    <TextBlock Text="Customer Statistics" FontWeight="SemiBold" FontSize="14" />
                    <TextBlock Text="{Binding CustomerSummary}" FontSize="12" Opacity="0.7" />
                </StackPanel>
                
                <!-- Bulk operations -->
                <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="8">
                    <Button ToolTipService.ToolTip="Export customer list">
                        <StackPanel Orientation="Horizontal" Spacing="4">
                            <SymbolIcon Symbol="Upload" />
                            <TextBlock Text="Export" />
                        </StackPanel>
                    </Button>
                    <Button ToolTipService.ToolTip="Backup customer database">
                        <StackPanel Orientation="Horizontal" Spacing="4">
                            <SymbolIcon Symbol="Save" />
                            <TextBlock Text="Backup" />
                        </StackPanel>
                    </Button>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Page>